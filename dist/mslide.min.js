/*! mslide.js 0.0.4a https://github.com/godxiaoji */ !function(a){function b(){}var c=a.navigator,d=c.userAgent.toLowerCase(),e=/android/i.test(d),f="touchstart",g="touchmove",h="touchend",i={prefix:function(){for(var a,b="t,webkitT,MozT,msT,OT".split(","),c=document.createElement("div").style,d=0;d<b.length;d++)if(a=b[d]+"ransform",a in c)return c=null,b[d].substr(0,b[d].length-1);return c=null,""}(),addPrefix:function(a,b){return""===this.prefix?a:b?this.prefix+a.charAt(0).toUpperCase()+a.substr(1):"-"+this.prefix.toLowerCase()+"-"+a},getTransVal:function(a,b){return"translate3d("+("x"===b?a+"px, 0px, 0px":"0px, "+a+"px, 0px")+")"}},j=i.addPrefix("transform"),k=i.addPrefix("transition"),l=i.addPrefix("transform",!0),m=i.addPrefix("transitionDuration",!0),n=function(a){var b=this;this.options=a||{},"y"===this.options.direction?(this.direction="y",this.directionGroup=["Y","X","Height","Width"]):(this.direction="x",this.directionGroup=["X","Y","Width","Height"]);var c=["linear","ease","ease-in","ease-out","ease-in-out"];this.easing=c[1],c.forEach(function(a){a===b.options.easing&&(b.easing=a)});var d=["index","onBeforeSlide","onSlide","autoPlay","interval","duration","slideType"];d.forEach(function(a){null!=b.options[a]&&(b[a]=b.options[a])}),this.follow=this.options.follow===!1||"fade"===this.slideType?!1:!0,this.target="string"==typeof this.options.selector?document.querySelector(this.options.selector):this.options.selector,this.list=this.options.listSelector?this.target.querySelector(this.options.listSelector):this.target.children[1],this.target.addEventListener(f,this,!1),this.setItems(),this.options.prevSelector&&(this.prevBtn="string"==typeof this.options.prevSelector?document.querySelector(this.options.prevSelector):this.options.prevSelector,this.prevBtn.addEventListener("click",this,!1)),this.options.nextSelector&&(this.nextBtn="string"==typeof this.options.nextSelector?document.querySelector(this.options.nextSelector):this.options.nextSelector,this.nextBtn.addEventListener("click",this,!1)),this.to(this.index),this.running=!1,this.autoPlay&&this.start()};n.prototype={autoPlay:!1,playing:!1,interval:4e3,duration:100,index:0,itemSize:0,getLastIndex:function(){return this.items.length-1},getCircleIndex:function(a){var b=this.items.length;return(this.index+b+a%b)%b},setItems:function(){return this.items=[].slice.call(this.list.children,0),"fade"===this.slideType?void this.setFadeStyle():void this.setSlideStyle()},setFadeStyle:function(){var a=this,b=this.list.offsetWidth,c=this.list.offsetHeight;this.list.style.width=b+"px",this.list.style.height=c+"px",this.items.forEach(function(d,e){d.style.cssText=["position: absolute;","left: 0;","top: 0;","width: "+b+"px;","Height: "+c+"px;",j+": "+i.getTransVal(0,this.direction)+";",k+": opacity 0ms "+a.easing+";"].join(""),d.style.opacity=0===e?1:0})},setSlideStyle:function(){var a=this.directionGroup[2],b=this.target["offset"+a];this.itemSize=b,this.target.style["overflow"+this.directionGroup[0]]="hidden",this.list.style.cssText=[a.toLowerCase()+": "+b*this.items.length+"px;",j+": "+i.getTransVal(-b*this.index,this.direction)+";",k+": "+j+" 0ms "+this.easing+";","-webkit-backface-visibility: hidden;","backface-visibility: hidden;","-webkit-perspective: 1000;","perspective: 1000;"].join(""),this.items.forEach(function(c){c.style[a.toLowerCase()]=b+"px"})},handleEvent:function(a){switch(a.type){case f:this.onTouchStart(a);break;case g:this.onTouchMove(a);break;case h:this.onTouchEnd(a);break;case"click":a.target==this.prevBtn?this.onPrevClick():a.target==this.nextBtn&&this.onNextClick()}},onBeforeSlide:b,onSlide:b,onTouchStart:function(a){var b=this;this.playing||(this.clear(),e&&(this.touchMoveTimeout=setTimeout(function(){b.resetStatus()},3e3)),this.target.removeEventListener(g,this,!1),this.target.removeEventListener(h,this,!1),this.target.addEventListener(g,this,!1),this.target.addEventListener(h,this,!1),delete this.horizontal,this.touchCoords={},this.touchCoords.startX=a.touches[0].pageX,this.touchCoords.startY=a.touches[0].pageY,this.touchCoords.timeStamp=a.timeStamp)},onTouchMove:function(a){if(this.touchCoords){this.touchCoords.stopX=a.touches[0].pageX,this.touchCoords.stopY=a.touches[0].pageY;var b=this.touchCoords.startX-this.touchCoords.stopX,c=this.touchCoords.startY-this.touchCoords.stopY;"y"===this.direction&&(b=[c,c=b][0]);var d=Math.abs(b),e=Math.abs(c);if("undefined"!=typeof this.horizontal)0!==b&&a.preventDefault();else{if(!(d>e))return delete this.touchCoords,void(this.horizontal=!1);this.horizontal=!0,0!==b&&a.preventDefault(),clearTimeout(this.touchMoveTimeout)}if(this.follow){var f=this.itemSize,g=this.index,h=g*f,j=this.getLastIndex();h+=0===g&&0>b||g==j&&b>0?Math.ceil(b/Math.log(Math.abs(b))):b,f>d&&(this.list.style[l]=i.getTransVal(-h,this.direction))}}},onTouchEnd:function(a){if(clearTimeout(this.touchMoveTimeout),this.target.removeEventListener(g,this,!1),this.target.removeEventListener(h,this,!1),this.touchCoords){var b,c=this.itemSize,d="x"===this.direction?this.touchCoords.startX-this.touchCoords.stopX:this.touchCoords.startY-this.touchCoords.stopY,e=Math.abs(d),f=this.index;isNaN(e)||0===e||(e>c&&(e=c),b=e>=80||a.timeStamp-this.touchCoords.timeStamp<200?d>0?f+1:f-1:f,this.to(b),delete this.touchCoords)}this.resetStatus()},onPrevClick:function(){this.clear(),this.prev(),this.autoPlay&&this.run()},onNextClick:function(){this.clear(),this.next(),this.autoPlay&&this.run()},prev:function(){this.to(this.index-1)},next:function(){this.to(this.index+1)},start:function(){this.running||(this.running=!0,this.clear(),this.run())},stop:function(){this.running=!1,this.clear()},clear:function(){clearTimeout(this.slideTimer),this.slideTimer=null},run:function(){var a=this;this.slideTimer||(this.slideTimer=setInterval(function(){a.to(a.getCircleIndex(1))},this.interval))},resetStatus:function(){this.autoPlay&&this.run()},to:function(a){var b=this.index;a>=0&&a<=this.getLastIndex()&&a!=b?this.slide(a):this.slide(b)},slide:function(a){var b=this,c=this.index;if(!this.playing){if(this.playing=!0,this.index=a,this.onBeforeSlide(a,c),"fade"===this.slideType){var d=a>=c?a:c;b.items[d].style[m]=this.duration+"ms",this.items[d].style.opacity=a>=c?1:0}else this.list.style[m]=this.duration+"ms",this.list.style[l]=i.getTransVal(-this.itemSize*a,this.direction);setTimeout(function(){b.playing=!1,"fade"===b.slideType?b.items[d].style[m]="0ms":b.list.style[m]="0ms",b.onSlide(a,c)},this.duration)}},refresh:function(){this.setItems();var a=this.getLastIndex();this.index>a&&this.to(a)},destroy:function(){this.destroyed=!0,this.stop(),this.target.removeEventListener(f,this,!1),this.target.removeEventListener(g,this,!1),this.target.removeEventListener(h,this,!1),this.prevBtn&&this.prevBtn.removeEventListener("click",this,!1),this.nextBtn&&this.nextBtn.removeEventListener("click",this,!1),this.target=this.list=this.items=this.prevBtn=this.nextBtn=null}},a.MSlide=n}(window);